# K-Means Clustering

## Working Principle

K-Means Clustering is a simple but powerful unsupervised learning :material-information-outline:{ title="Unsupervised learning is a technique that involves a mathematical model learning the underlying patterns of a given data without any external assistance. This can allow us to see patterns that humans may have never thought of." } algorithm. K-Means Clustering aims to divide a given sample data into "k" groups. The process is intuitivly simple:

1. Place k number centroids of the clusters in random locations in the data space.
2. For each sample in the data space, associate its class with the nearest centroid.
3. For each cluster, compute the geometric center and move the centroids there.
4. Repeat step 2 and 3 until you don't need to change the location of the centroid.

???+ info "Automatically compute "k""
    There is a way to find the number of clusters(k) you need. This technique utilizes the elbow curve that is generated by creating a line graph of the number of clusters "k" and the corresponding reduction in variation. This is not currently implemented in MAGIST, but there are plans to implement it soon.



<figure markdown>
  ![Selection_070](https://user-images.githubusercontent.com/85193239/176778877-384e5228-5580-4bad-bc16-250767a91775.png)
  [^1]
</figure>

<figure markdown>
  ![K-means_convergence](https://user-images.githubusercontent.com/85193239/176778939-b0c2596b-5b52-4b08-add9-749bd97e3b63.gif)
  [^1]
</figure>


## Implementation Using MAGIST

Currently, MAGIST uses K-Means Clustering for masking images. It attempts to identify individual objects in an image which can then be further processed to extract more information. For this, you must use the `UnsupervisedModels` under the `Vision` directory. It can be imported like so:

```python
from MAGIST.Vision.UnsupervisedModels.img_cluster import RoughCluster # (1)
```

1. UnsupervisedModels contains a Python file named `img_cluster.py` that contains the `RoughCluster` class. This is where all the necessary methods for computing the clusters.

!!! note
    This computation is done with the help of SciKit-Learn and Pandas.

Now, create an instance of the `RoughCluster` class:

```python
clusterer = RoughCluster("PATH/TO/CONFIG.json") # (1)
```

1. More information about the config file is located here: [Setup Config File](/Configuration/1 - Setup Config File)

Finally, we can compute the cluster:

```python
n_of_clusters = 3
img_location = "Data/test.jpg"
img_size = (200, 200)
masked_img_dir = "Data/Clusters"

masked_img_locations = clusterer.unsupervised_clusters(n_of_clusters, img_location, img_size, masked_img_dir)
```

Here is what `masked_img_locations` should look like:

```python
["Data/Clusters/masked0.jpg", "Data/Clusters/masked1.jpg", "Data/Clusters/masked2.jpg"] # (1)
```

1. The amount of images listed depends on the `n_of_clusters`.

These images are the final masked results. Through the config file, you can enable verbose to see the intermediate stage before it individually exporting the images.


[^1]: These images were acquired from [WikiPedia](https://en.wikipedia.org/wiki/K-means_clustering).
